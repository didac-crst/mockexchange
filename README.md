# MockExchange Suite

**_Trade without fear, greed, or actual money ‚Äî because sometimes the best way to lose less is to not play at all._**

This repository contains the full **MockExchange** paper-trading platform:
- **MockX Engine** ‚Äì Matching engine, portfolio tracking, and API layer.
- **MockX Periscope** ‚Äì Streamlit-based dashboard for visualizing portfolio and orders.
- **MockX Oracle** ‚Äì Price feed service (e.g., Binance via CCXT ‚Üí Valkey).
- **MockX Gateway** (external repo) ‚Äì Lightweight Python wrapper for the MockX Engine API, providing a ccxt-style interface for bots and scripts.

---

## üìë Table of Contents

- [MockExchange Suite](#mockexchange-suite)
  - [üìë Table of Contents](#-table-of-contents)
  - [TL;DR](#tldr)
  - [üìú Story](#-story)
  - [Core Features](#core-features)
  - [üó∫ Architecture \& Ecosystem](#-architecture--ecosystem)
    - [Related Repositories](#related-repositories)
  - [üì¶ Packages in this Monorepo](#-packages-in-this-monorepo)
  - [üöÄ Quick Start](#-quick-start)
    - [0. Prepare Valkey (Redis)](#0-prepare-valkey-redis)
    - [1. Start MockX Oracle üîÆ](#1-start-mockx-oracle-)
    - [2. Start MockX Engine](#2-start-mockx-engine)
    - [3. Start MockX Periscope](#3-start-mockx-periscope)
  - [üóÇ Monorepo Structure](#-monorepo-structure)
  - [üìö Documentation](#-documentation)
  - [ü™™ License](#-license)

---

## TL;DR

- Stateless, deterministic, no-risk spot-exchange emulator.
- ccxt-compatible API ‚Äî test bots without touching live markets.
- Externalized price feed (MockX Oracle) so you can swap sources.
- Companion Streamlit dashboard (MockX Periscope) for monitoring.
- Full CLI + REST API + Docker support.

---

## üìú Story

> It was **2013**, and Bitcoin had just hit a jaw-dropping **$300**.  
> Someone in our old engineering WhatsApp group brought it up.  
> I asked innocently, *‚ÄúWhat‚Äôs that?‚Äù*  
>  
> The response came instantly, dripping with confidence:  
> *‚ÄúYou‚Äôre too late ‚Äî this bubble is about to burst‚Ä¶‚Äù*  
>  
> Which, in hindsight, was probably the most confidently
> wrong (and overly cautious) financial advice I‚Äôve ever received.

But something about it intrigued me. I didn‚Äôt fully understand it.  
I didn‚Äôt even think it would work ‚Äî and yet, I bought in.  
Just **2/3 of a BTC**, about **180‚ÄØ‚Ç¨**, which, at the time, I mentally wrote off as *‚Äúmoney I‚Äôll never see again.‚Äù*  
Spoiler: it was the **best terrible financial decision** I‚Äôve ever made.

I held.  
And held.  
And held some more.

Then came **2017** ‚Äî the year of Lambos, moon memes, and FOMO-induced insomnia.  
I began checking prices at night before bed, and again first thing in the morning ‚Äî
not for fun, but to confirm whether I was now rich‚Ä¶ or still stuck working 9 to 5.

This, of course, led me to the **classic rookie move**: diversification.  
I dove into altcoins with names like **LTC**, **TROY**, and others I‚Äôve repressed like a bad haircut from high school.  
Let‚Äôs just say: they didn‚Äôt go to the moon ‚Äî they dug a tunnel.

Decision after decision, I watched my gains **evaporate in slow motion**.  
Eventually, I realized I needed support ‚Äî not from a financial advisor (they‚Äôd only
remind me of my poor decisions), but from something more aligned with my goals ‚Äî not theirs.

**Something logical**.  
Emotionless.  
Free from fear and greed.  
Unimpressed by sudden price spikes or Twitter hype.  
A system that won‚Äôt panic sell or chase pumps.

I wanted an intelligent system that could make decisions based on **data**, not **dopamine**.  
Something that would just execute the plan, no matter how boring or unsexy that plan was.  
Something more disciplined than I‚Äôd ever been ‚Äî able to stay locked on a single task for hours, without fatigue, distraction, or the urge to check the news.

In short, I wanted to build a **trader with no feelings** ‚Äî
like a **psychopath**, but helpful.

So in **2020**, full of optimism and free time, I enrolled in an **AI-for-trading** program.  
I was ready to automate the pain away.

Then‚Ä¶ I became a dad.

Suddenly, my trading ambitions were replaced with diapers, sleep deprivation,
and learning the fine art of **negotiating with toddlers**.  
Needless to say, the bot went on standby ‚Äî alongside my hobbies, ambitions, and most adult-level reasoning.

Fast forward to **2024**. The kids sleep (sometimes), and my curiosity roared back to life.  
I decided it was time to build ‚Äî **for real**.  
Not to get rich ‚Äî but because this is what I do for fun:
connect dots, explore computer science, study markets, and challenge my past self
with fewer emotional trades and more intelligent systems.

But ideas need hardware.  
So I bought my first Raspberry Pi.  
Because if I was going to burn time, I wasn‚Äôt about to burn kilowatts.  
I needed something that could run 24/7 without turning my electricity bill into a second mortgage.  
Resilient, quiet, efficient ‚Äî like a monk with a TPU, ready to meditate on market patterns in silence for as long as it takes.  
It wasn‚Äôt much, but it was enough to get started.

From there, the system began to grow ‚Äî and spiral.  
Scraping prices in real time, keeping databases efficient, aggregating data, archiving old data,
writing little scripts that somehow become immortal zombie processes needing to be killed by hand...  
I genuinely didn‚Äôt expect it to be so much.

And yet ‚Äî I like it.  
This is how I relax: designing systems no one asked for, solving problems I created myself,  
and picking up strange new skills in the process ‚Äî the kind you never set out to learn, but somehow end up mastering.

Which brings us to **2025**, and **MockExchange**:  
a stateless, deterministic, no-risk spot-exchange emulator that speaks fluent **ccxt**,
pretends it‚Äôs real, and stores the last price-tick, balance and order in **Valkey** (aka Redis) ‚Äî
instead of touching live markets ‚Äî so you can test, dry-run, and debug your bot
without risking a single satoshi.

No more fear.  
No more ‚Äúshould I have bought?‚Äù or ‚Äúwhy did I sell?‚Äù  
Just logic, fake orders, and enough tooling to safely build the thing
that trades smarter than I did.

---

## Core Features

- üêç Import as a Python package for back-tests.
- üê≥ Run as a Docker container with a FastAPI server.
- üíª Use quick commands via the `mockx` CLI.
- Commission model & order-matching engine configurable via env vars.
- Works with any key-value feed providing latest price per symbol.

---

## üó∫ Architecture & Ecosystem

```mermaid
flowchart TB
    subgraph Clients
        periscope["MockX Periscope<br/>(Streamlit UI)"]
        bot["Trading Bot / Script"]
    end

    subgraph Infra
        redis[("Valkey / Redis")]
        engine["MockX Engine üìà"]
    end

    subgraph External
        binance["Binance (Live Market Data)"]
    end

    bot -->|ccxt-like API| gateway["MockX Gateway üõ°"]
    periscope -->|HTTP/REST| engine
    gateway -->|HTTP/REST| engine

    engine --> redis

    oracle["MockX Oracle üîÆ<br/>(ccxt ‚Üí Redis)"] --> redis
    binance -->|ccxt| oracle
```

### Related Repositories

- **MockX Gateway** ‚Äì https://github.com/didac-crst/mockexchange-gateway  
    Minimal ccxt-style Python client to interact with the Engine API (install via `pip`).

---

## üì¶ Packages in this Monorepo

| Package             | Path                  | Description                                                  | README                                           |
| ------------------- | --------------------- | ------------------------------------------------------------ | ------------------------------------------------ |
| **MockX Engine**    | `packages/engine/`    | Core engine, order-matching, balances, API layer, CLI tools. | [Engine README](packages/engine/README.md)       |
| **MockX Periscope** | `packages/periscope/` | Streamlit dashboard for portfolio and orders.                | [Periscope README](packages/periscope/README.md) |
| **MockX Oracle**    | `packages/oracle/`    | Market data feeder (ccxt ‚Üí Valkey/Redis).                    | [Oracle README](packages/oracle/README.md)       |

Related (external):
- **MockX Gateway** ‚Äì https://github.com/didac-crst/mockexchange-gateway

---

## üöÄ Quick Start

**Order matters** ‚Äî without Valkey + Oracle, the Engine has no prices.

### 0. Prepare Valkey (Redis)
Install or run via Docker:
```bash
docker run -d --name valkey -p 6379:6379 valkey/valkey
```

---

### 1. Start MockX Oracle üîÆ
This service writes latest market prices into Valkey.

Example Docker Compose:
```yaml
services:
    oracle:
    image: python:3.11-slim
    environment:
        EXCHANGE: "binance"
        SYMBOLS: "BTC/USDT,ETH/USDT"
        REDIS_URL: "redis://host.docker.internal:6379/0"
        INTERVAL_SEC: "10"
    volumes:
        - ./oracle.py:/app/oracle.py:ro
    working_dir: /app
    command: ["python", "-u", "oracle.py"]
```

Minimal `oracle.py`:
```python
import os, time
import ccxt, redis

ex = getattr(ccxt, os.getenv("EXCHANGE", "binance"))({"enableRateLimit": True})
r = redis.Redis.from_url(os.getenv("REDIS_URL", "redis://127.0.0.1:6379/0"), decode_responses=True)
SYMBOLS = os.getenv("SYMBOLS", "BTC/USDT").split(",")
INTERVAL_SEC = int(os.getenv("INTERVAL_SEC", "10"))

while True:
    try:
        tickers = ex.fetch_tickers(SYMBOLS)
        for sym, t in tickers.items():
            r.hset(f"sym_{sym}", mapping={
                "price": t["last"],
                "timestamp": time.time(),
                "bid": t.get("bid"), "ask": t.get("ask"),
                "bidVolume": t.get("bidVolume") or 0.0,
                "askVolume": t.get("askVolume") or 0.0,
                "symbol": sym
            })
    except Exception as e:
        print("oracle error:", e)
    time.sleep(INTERVAL_SEC)
```

---

### 2. Start MockX Engine
```bash
cd packages/engine
cp .env.example .env
docker compose -p mockx-engine up --build
```
API: http://localhost:8000

---

### 3. Start MockX Periscope
```bash
cd packages/periscope
cp .env.example .env
# Ensure API_URL in .env points to engine (default: http://localhost:8000)
docker compose -p mockx-periscope up --build
```
UI: http://localhost:8501

---

## üóÇ Monorepo Structure
```text
mockexchange/
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ engine/        # MockX Engine
‚îÇ   ‚îú‚îÄ‚îÄ periscope/     # MockX Periscope
‚îÇ   ‚îî‚îÄ‚îÄ oracle/        # MockX Oracle
‚îú‚îÄ‚îÄ .github/workflows/ # CI
‚îî‚îÄ‚îÄ README.md          # This file
```

---

## üìö Documentation

- [Engine README](packages/engine/README.md)
- [Periscope README](packages/periscope/README.md)
- [Oracle README](packages/oracle/README.md)
- [MockX Gateway](https://github.com/didac-crst/mockexchange-gateway)

---

## ü™™ License

MIT License ‚Äì see the licenses inside each package.

> **Don‚Äôt risk real money.**  
> Spin up MockExchange, hammer it with tests, then hit live markets only when your algos are solid.